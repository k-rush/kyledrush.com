
<!DOCTYPE html>
<head>
<title>District 40 - Alcoholics Anonymous - Seattle</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="shortcut icon" href="images/aa.ico">

<link rel="stylesheet" href="layout/styles/style.css" type="text/css" />
<link rel="stylesheet" href="bootstrap/css/bootstrap.css" type="text/css" />
<link rel="stylesheet" href="jquery-ui/jquery-ui.css" type="text/css" />
<link rel="stylesheet" href="jquery-ui/jquery-ui.structure.css" type="text/css" />
<link rel="stylesheet" href="jquery-ui/jquery-ui.theme.css" type="text/css" />
<link rel='stylesheet' href='fullcalendar/fullcalendar.min.css' />

<script src='fullcalendar/moment.min.js'></script>
<script type="text/javascript" src="layout/scripts/jquery.js"></script>
<script type="text/javascript" src="jquery-ui/jquery-ui.js"></script>
<script src='fullcalendar/fullcalendar.min.js'></script>
<script src='fullcalendar/gcal.min.js'></script>
<script src="layout/scripts/jquery.ba-hashchange.js"></script>

<script>

function onLoadHome() {
  //debugger;

  var days = {'0':'Sunday','1':'Monday','2':'Tuesday','3':'Wednesday','4':'Thursday','5':'Friday','6':'Saturday'};
  var html = "";
  /** Get the meetings data into array, format it to display.*/
  //$.getJSON('https://area72aa.org/wp-admin/admin-ajax.php?action=meetings', function( data ) {
  $.getJSON('meetings.json', function( data ) {
    html += '<table class="table"><thead><tr><th>Meeting</th><th>Location</th><th>Time</th><th>Day</th></th></thead><tbody>';
    //Building the meetings list
    data.forEach(function(element, i) {
        if(element["notes"] == "District 40") {
          html += "<tr><td>" + element['name'] + "</td><td>" +  element['location'] + "<br>" + element['formatted_address'] + "</td><td>" + element['time_formatted'] +  "</td><td>" + days[element['day']] + "</td></tr>";
        }
      });
    html += "</tbody></table>";
    $("#home-meetings").append(html);
    $("#home-meetings-loading").hide();

  });


};

function onLoadEvents() {
  /** Full calendarize the full calendar. */
  $('#calendar').fullCalendar({
      header: {
        left: 'prev,next',
        center: 'title',
        right: 'month,listMonth'
      },
      
      googleCalendarApiKey: 'AIzaSyCWpIKSa_JHQWRxrQwc8ToBv6qVr3FZ5d0',
    
      events: 'cokqd4dp5giqibfd52fn50pcbc@group.calendar.google.com',
      
      eventClick: function(event) {
        // opens events in a popup window
        window.open(event.url, 'gcalevent', 'width=700,height=600');
        return false;
      },
      
      loading: function(bool) {
        $('#loading').toggle(bool);
      }
      
    });
  
};

var cache = new Object();
//{'':$('<div class="item">').appendTo("#content-container").load('home.html')};

/** Hash-change, simple cache function */
$(function() {
    //debugger;
    //cache[''] = $('<div class="item">').appendTo("#content-container").load('home.html');
    $(window).hashchange(function() {

      //alert("hashchange");

      var url = window.location.hash.replace('#', '');
      if(url == "") {
        url = "home.html";
      }
      
      $("#content-container").children(":visible").hide();
      
      if ( cache[url] ) {  
        //debugger;
        cache[url].show();
      } else {
          cache[url] = $('<div class="item">').appendTo("#content-container").load(url, function() {
          $("#content-container").ready(function() {
            if(url == "home.html") onLoadHome();
            else if (url == "events.html") onLoadEvents();
          });

        });

      }
    });

    $(window).hashchange();

});
</script>

</head>

<body>

  <div id="header" class="row-fluid">

    <div class="row-fluid">

      <div id="logo" class="span6">
        <a href="#"><h1>District 40</h1></a>
        <h2>Alcoholics Anonymous</h2>
      </div>

      <div id="location" class="span5">
        <h4>"We must carry the message, else we ourselves can wither and those who haven't been given the truth may die" 
          <br>(from A.A.'s Legacy of Service by Bill W.)</h4>
      </div>

    </div>
  </div>

  <div id = "navbar" class="row-fluid">

    <div id="nav" class="span10 offset1">
      
        <ul>
          <li><a class="update-content" href="#home.html">Meetings</a></li>
          <li><a class="update-content" href="#events.html">Events</a></li>
          <li><a class="update-content" href="#contact.html">Contact</a></li>
        </ul>
        </ul>
    </div>

    
  </div>
      
    

  <!-- MAIN CONTENT AREA - Ajax calls will fill this with html. -->
  <div id="content-container" class="row-fluid">
    
  </div>



</body>
</html>